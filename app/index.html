<!DOCTYPE html>
<html ng-app="app" ng-controller="MainCtrl">

<head>
	<meta charset="UTF-8">
	<title>Kedis - Redis desktop manager v2.0</title>
	<link href="./css/bootstrap.min.css" rel="stylesheet">
    <link href="./css/all.min.css" rel="stylesheet">
    <link href="./node_modules/jquery-ui-dist/jquery-ui.min.css" rel="stylesheet">
	<script>
		window.$ = window.jQuery = require('jquery');
	</script>
	<script src="./node_modules/jquery-ui-dist/jquery-ui.min.js"></script>
	<script type="text/javascript" src="./scripts/angular.min.js"></script>
	<script type="text/javascript" src="./scripts/angular-ui-router.min.js"></script>
	<script type="text/javascript" src="./scripts/ui-bootstrap-tpls-3.0.4.min.js"></script>
	<script type="text/javascript" src="./scripts/electangular.js"></script>
	<script type="text/javascript" src="./src/App.js"></script>
	<script type="text/javascript" src="./src/directive/CustomDirectives.js"></script>
	<script type="text/javascript" src="./src/MainCtrl.js"></script>
	<script type="text/javascript" src="./src/ServerCtrl.js"></script>
	<script type="text/javascript" src="./src/KeyCtrl.js"></script>
	<script type="text/javascript" src="./src/StringValueCtrl.js"></script>
	<script type="text/javascript" src="./src/HashValueCtrl.js"></script>
	<script type="text/javascript" src="./src/ListValueCtrl.js"></script>
	<script type="text/javascript" src="./src/SetValueCtrl.js"></script>
	<script type="text/javascript" src="./src/ZsetValueCtrl.js"></script>
	<script type="text/javascript" src="./src/DefaultCtrl.js"></script>
</head>

<body>
	<div id="content">
		<div class="row no-gutters" style="height:100%;">
			<div id="server" ng-controller="ServerCtrl">
				<!-- 服務器列表 -->
				<div class="panel" style="height:70%;">
					<div class="panel-content">
						<div class="input-group mb-3" style="margin-bottom: 0 !important;">
							<div class="input-group-prepend">
								<span class="input-group-text" id="basic-addon3">筛选服务器</span>
							</div>
							<input ng-change="filterServer()" ng-model="filterText" type="text" style="border-right: none;" class="form-control" id="serverFilter"
							    aria-describedby="basic-addon3" placeholder="在此输入筛选条件">
						</div>
						<div class="list" style="height: 100%; overflow: auto;">
							<div ng-right-click="showServerContextMenu(item)" ng-hide="item.hide" class="list-item" ng-class="{'selected': item.selected}"
							    ng-repeat="item in serverList track by $index" ng-click="serverClick(item)">
								<span>{{item.name}}</span>
								<span class="badge badge-myself" style="float: right;" ng-show="item.isCluster">CLUSTER</span>
								<span class="badge badge-string" style="float: right;" ng-show="item.ssh">SSH</span>
							</div>
						</div>
					</div>
				</div>
				<!-- 服務器狀態列表 -->
				<div id="inputChart" ng-show="showChart" class="panel top-line" style="height: calc(30% - 1px); user-select: none;"></div>
				<div id="clusterList" ng-show="!showChart" class="panel top-line" style="height: calc(30% - 1px); user-select: none;">
					<div class="list" style="height: 100%; overflow: auto;">
						<div class="list-item" ng-repeat="item in selectedServer.nodes track by $index" ng-right-click="showClusterContextMenu(item)">
							<span>{{item.host}}:{{item.port}}</span>
							<span ng-repeat="type in item.types track by $index" class="badge badge-{{type}}" style="float: right; margin-left: 3px;">{{type.toUpperCase()}}</span>
						</div>
					</div>
				</div>
			</div>
			<div id="key" ng-controller="KeyCtrl">
				<div class="panel" style="height: 100%;">
					<div class="panel-content">
						<div class="input-group mb-3" style="margin-bottom: 0 !important;">
							<div class="input-group-prepend">
								<span class="input-group-text" id="basic-addon3">筛选KEY</span>
							</div>
							<input type="text" ng-change="filterKey()" ng-model="keyParttern" style="border-right: none;" placeholder="在此输入筛选条件" class="form-control"
							    id="basic-url" aria-describedby="basic-addon3">
						</div>
						<div id="databaseList" em-height-source class="container-fluid no-padding">
							<div class="row no-gutters redis-databse">
								<div class="col-sm" ng-repeat="item in databases track by $index">
									<button type="button" ng-click="showKeys(item)" ng-class="{'btn-danger': item.selected,'btn-secondary':!item.selected}" class="btn">{{item.index}}</button>
								</div>
							</div>
						</div>
						<div id="keyList" em-height-target class="list" style="height:calc(100% - 64px); overflow: auto;">
							<div ng-right-click="showKeyContextMenu(key)" class="list-item" ng-hide="key.hide" ng-class="{'selected': key.selected}"
							    ng-click="selectKey(key)" style="overflow: hidden;" ng-repeat="key in keys track by $index">
								<span class="keyLabel">{{key.name}}</span>
								<span class="badge badge-{{key.type}}" style="float: right;">{{key.type.toUpperCase()}}</span>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div id="value">
				<div class="panel" style="height:100%;">
					<div class="panel-content" ui-view>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="container-fluid bottom-bar">
		<span ng-show="serverInfos">{{keyCount|| 0}} 个键</span>
		<span ng-show="serverInfos" style="margin-left: 10px;">{{serverInfos.Clients.connected_clients || 0}} 个客户端</span>
		<span ng-show="serverInfos" style="margin-left: 10px;">Redis版本号: {{serverInfos.Server.redis_version}}</span>

		<span ng-show="clusterInfos">集群状态 {{clusterInfos.cluster_state}}</span>
		<span ng-show="clusterInfos" style="margin-left: 10px;">集群大小 {{clusterInfos.cluster_size}}</span>
		<span ng-show="clusterInfos" style="margin-left: 10px;">已知节点 {{clusterInfos.cluster_known_nodes}} 个</span>


		<span style="float: right; margin-left: 10px;">Kedis版本号: 2.0.4</span>
		<span style="float: right; margin-left: 10px;" style="cursor: help; user-select: none;" ng-click="openBrowser($event,'https://gitee.com/kehaw9818/Kedis')">
			<i class="fab fa-git-square"></i>
		</span>
		<div id="lastError" class="error"></div>

	</div>
</body>

</html>
